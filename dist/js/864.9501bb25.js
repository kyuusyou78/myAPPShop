"use strict";(self["webpackChunkhm_shopping"]=self["webpackChunkhm_shopping"]||[]).push([[864],{864:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{title:"会员登录","left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)}}}),t._m(0),t._m(1),e("div",{staticClass:"inpBox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.mobile,expression:"mobile"}],staticClass:"mobile",attrs:{placeholder:"请输入手机号码"},domProps:{value:t.mobile},on:{input:function(e){e.target.composing||(t.mobile=e.target.value)}}}),e("hr",{staticClass:"hr1"}),e("div",{staticClass:"CodeBox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.picCode,expression:"picCode"}],staticClass:"Code",attrs:{placeholder:"请输入图形验证码"},domProps:{value:t.picCode},on:{input:function(e){e.target.composing||(t.picCode=e.target.value)}}}),t.picUrl?e("img",{staticClass:"CodeImg",attrs:{src:t.picUrl},on:{click:t.getCode}}):t._e()]),e("hr",{staticClass:"hr1"}),e("div",{staticClass:"mobileCode"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.msgCode,expression:"msgCode"}],attrs:{placeholder:"请输入短信验证码"},domProps:{value:t.msgCode},on:{input:function(e){e.target.composing||(t.msgCode=e.target.value)}}}),e("button",{staticClass:"btn-mc",on:{click:t.getTotalCode}},[t._v(t._s(t.second===t.totalSecond?"获取验证码":"等待"+t.totalSecond+"秒后获取"))])]),e("hr",{staticClass:"hr1"})]),e("div",[e("button",{staticClass:"loginBtn",on:{click:t.Login}},[t._v("登录")])])],1)},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"title"},[e("h2",[t._v("手机号登录")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"SmallTitle"},[e("h5",[t._v("未注册的手机号登录后将自动注册")])])}],a=s(2756);const n=()=>a.A.get("/captcha/image"),r=(t,e,s)=>a.A.post("/captcha/sendSmsCaptcha",{form:{captchaCode:t,captchaKey:e,mobile:s}}),c=(t,e)=>(0,a.A)({url:"/passport/login",method:"post",data:{form:{isParty:!1,mobile:t,partyData:{},smsCode:e}}});var l={name:"LoginIndex",data(){return{picCode:"",picUrl:"",picKey:"",second:60,totalSecond:60,timmer:null,mobile:"",msgCode:""}},async created(){this.getCode()},methods:{async getCode(){const t=await n();this.picUrl=t.data.base64,this.picKey=t.data.key},verifyFn(){return/0?(13|14|15|18)[0-9]{9}/.test(this.mobile)?!!/^[A-Za-z0-9]{4}$/.test(this.picCode)||(this.$toast("请输入正确的验证码"),!1):(this.$toast("请输入正确的手机号"),!1)},async getTotalCode(){this.verifyFn()&&(this.timmer||this.totalSecond!==this.second||(await r(this.picCode,this.picKey,this.mobile),this.$toast("短信发送成功,验证码为246810"),this.timmer=setInterval((()=>{this.totalSecond--,this.totalSecond<=0&&(clearInterval(this.timmer),this.timmer=null,this.totalSecond=this.second)}),1e3)))},async Login(){if(!this.verifyFn())return;if(!/^\d{6}$/.test(this.msgCode))return void this.$toast("请输入正确的手机验证码");const t=await c(this.mobile,this.msgCode);console.log(t),this.$store.commit("user/getUserInfo",t.data),this.$toast("登录成功");const e=this.$route.query.backUrl||"/";this.$router.replace(e)}},destroyed(){clearInterval(this.timmer)}},d=l,m=s(6501),h=(0,m.A)(d,i,o,!1,null,"7c97415c",null),p=h.exports}}]);
//# sourceMappingURL=864.9501bb25.js.map